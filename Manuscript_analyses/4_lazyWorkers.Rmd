---
title: "lazyWorkers"
author: "ES"
date: "7/24/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# load packages
```{r}
library(ggplot2)   # plots
library(tidyverse) # piping
library(dplyr)     # summarise
```

# load data
```{r}
# load bees with 0 observations
noObsBees <- read.csv("../Data/noObsBees.csv")
noObsBees <- noObsBees[, c("nestID", "beeID")]

# load bees with 1-2 observations
lowCountsBees <- read.csv("../Data/tempData/lowCountsBees.csv")
lowCountsBees <- lowCountsBees[, c("nestID", "beeID")]

# merge together for single df with all bees not included in nmds/dol analyses
lazyBees <- rbind(noObsBees, lowCountsBees)

# load obs_data to get a list of all the nestIDs
allBees <- read.csv("../Data/allBees.csv")
allBees <- allBees[, c("nestID", "beeID")]


allBees
lazyBees
```

# format and visualize data for number of lazy bees
```{r}
# include all nestIDs so that nests with 0 lazy workers are also included
allNests <- unique(allBees$nestID)
allNests

# add all nests to all dfs
nestsToAdd <- matrix(nrow = length(allNests), ncol = 2)
nestsToAdd <- as.data.frame(nestsToAdd)
colnames(nestsToAdd) <- colnames(noObsBees)
nestsToAdd$nestID <- allNests

noObsBees <- rbind(nestsToAdd, noObsBees)
lowCountsBees <- rbind(nestsToAdd, lowCountsBees)
lazyBees <- rbind(nestsToAdd, lazyBees)

# add nestTYPE column for all dfs
noObsBees$nestTYPE <- substr(noObsBees$nestID, start = 1, stop = 2)
lowCountsBees$nestTYPE <- substr(lowCountsBees$nestID, start = 1, stop = 2)
lazyBees$nestTYPE <- substr(lazyBees$nestID, start = 1, stop = 2)

# order the nestTYPEs so they appear in order of number of bees on graph
noObsBees$nestTYPE <- ordered(noObsBees$nestTYPE, levels = c("NT", "QT", "NF", "QF"))
lowCountsBees$nestTYPE <- ordered(lowCountsBees$nestTYPE, levels = c("NT", "QT", "NF", "QF"))
lazyBees$nestTYPE <- ordered(lazyBees$nestTYPE, levels = c("NT", "QT", "NF", "QF"))

########################### visualize

# zero observations
noObsPerNest <- noObsBees %>% dplyr::group_by(nestID, nestTYPE) %>% dplyr::summarise(nBees = dplyr::n() - 1) # subtract 1 b/c all nests have been added with 0 value

ggplot(noObsPerNest, aes(nBees, nestTYPE, color = nestTYPE)) +
  geom_point(position = position_jitter(width=0.2, height=0.2), alpha = 0.4) +
  stat_summary(fun = mean, geom = "point", size = 5) +
  labs(x = "number of bees with 0 observations per nest")

# 1-2 observations
lowCountsPerNest <- lowCountsBees %>% dplyr::group_by(nestID, nestTYPE) %>% dplyr::summarise(nBees = dplyr::n() - 1) # subtract 1 b/c all nests have been added with 0 value

ggplot(lowCountsPerNest, aes(nBees, nestTYPE, color = nestTYPE)) +
  geom_point(position = position_jitter(width=0.2, height=0.2), alpha = 0.4) +
  stat_summary(fun = mean, geom = "point", size = 5) +
  labs(x = "number of bees with 1-2 observations per nest")

# 0-2 observations
lazyPerNest <- lazyBees %>% dplyr::group_by(nestID, nestTYPE) %>% dplyr::summarise(nBees = dplyr::n() - 1) # subtract 1 b/c all nests have been added with 0 value

ggplot(lazyPerNest, aes(nBees, nestTYPE, color = nestTYPE)) +
  geom_point(position = position_jitter(width=0.2, height=0.2), alpha = 0.4) +
  stat_summary(fun = mean, geom = "point", size = 5) +
  labs(x = "number of bees with 0-2 observations per nest")
ggsave("../figures/lazyBees.jpg")
```

# format and visualize proportion of lazy bee data
```{r}
# 0-2 observations per bee

# add column for the proportion of lazy bees per nest
lazyPerNest$propBees[lazyPerNest$nestTYPE == "NT"] <- lazyPerNest$nBees[lazyPerNest$nestTYPE == "NT"] / 3
lazyPerNest$propBees[lazyPerNest$nestTYPE == "QT"] <- lazyPerNest$nBees[lazyPerNest$nestTYPE == "QT"] / 4
lazyPerNest$propBees[lazyPerNest$nestTYPE == "NF"] <- lazyPerNest$nBees[lazyPerNest$nestTYPE == "NF"] / 5
lazyPerNest$propBees[lazyPerNest$nestTYPE == "QF"] <- lazyPerNest$nBees[lazyPerNest$nestTYPE == "QF"] / 6

# plot it
ggplot(lazyPerNest, aes(propBees, nestTYPE, color = nestTYPE)) +
  geom_point(position = position_jitter(width=0.2, height=0.2), alpha = 0.4) +
  stat_summary(fun = mean, geom = "point", size = 5) +
  labs(x = "proportion of bees with 0-2 observations per nest")
ggsave("../figures/proportionLazyBees.jpg")
```